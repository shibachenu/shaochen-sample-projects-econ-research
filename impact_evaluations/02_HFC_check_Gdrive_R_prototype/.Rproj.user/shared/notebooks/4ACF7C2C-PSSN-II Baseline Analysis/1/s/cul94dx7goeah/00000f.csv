"0","hh_constructed = read_dta(file.path(Sys.getenv(""analysis_baseline_data_dir""), ""HHSurvey.dta""))"
"0","hh_numeric <- hh_constructed %>% select(where(is.numeric))"
"0",""
"0","# Filter out columns with too many missing values (e.g. >20%)"
"0","threshold = 0.05"
"0","hh_filtered <- hh_numeric  %>%"
"0","  select(where(~ mean(is.na(.)) <= threshold))"
"0",""
"0",""
"0","# Filter out constant columns"
"0","hh_filtered <- hh_filtered %>%"
"0","  select(where(~ var(.) != 0))"
